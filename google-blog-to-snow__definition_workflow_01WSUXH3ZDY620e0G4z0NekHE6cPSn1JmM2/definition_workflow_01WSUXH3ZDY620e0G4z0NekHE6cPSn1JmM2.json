{
  "workflow": {
    "unique_name": "definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2",
    "name": "Google TAG - Blog Post to SecureX Casebook\u0026SNOW",
    "title": "Google TAG - Blog Post to SecureX Casebook\u0026SNOW",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Number of Non-Clean Observables",
          "type": "datatype.integer",
          "description": "How many non-clean observables were found during the investigation (as in: unknown, suspicious, or malicious)",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH479XN83HOsjyra8ucTMGFmXPE9ch",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the Threat Response environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH47AF6G4RJpHdyZvmjgE3kL4moHBh",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.date",
        "properties": {
          "value": "0001-01-01T00:00:00+00:00",
          "scope": "local",
          "name": "Threat Response Token Time",
          "type": "datatype.date",
          "description": "The time at which the Threat Response access token was last fetched. This is used to determine when it's time to fetch a new token and should not be modified",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Access Token",
          "type": "datatype.secure_string",
          "description": "Placeholder for the Threat Response access token. This token will be fetched as needed throughout the workflow and this variable should not be modified",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Sightings",
          "type": "datatype.string",
          "description": "Placeholder for a list of sightings from your Threat Response modules. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH4797902wMICBdUmBMlzvcPMvdKdM",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "Webex Teams Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex Teams API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH47B4TE23rLJNXQ9OcTPnIo2KRMMW",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Targets",
          "type": "datatype.string",
          "description": "Placeholder for a list of targets from your Threat Response module sightings. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH47ANQM3yIokMsZwztjmtmWYPs3fg",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "Webex Teams Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex Teams room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH47A65O30PkUtWDBC5rivw0rea6Ua",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Webex Text",
          "type": "datatype.string",
          "description": "Placeholder for the text to send via Webex. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH478NFJ1hf3TMfihT1tThsvwf5xt5",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Non-Clean Observables",
          "type": "datatype.string",
          "description": "A JSON-formatted list of observables that have a disposition of unknown, suspicious, or malicious. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH479OBO7L7JcyiOxVq3hMm0JynHQc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "Blog Post URL",
          "type": "datatype.string",
          "description": "The URL of the blog post to investigate. This will be provided by the parent workflow",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01WSUXH479FVP52PA8AGYZNr5Fzx0ojGYMZ",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow takes a Google TAG blog post, conducts an investigation into it using Cisco Threat Response, and then puts the results in a SecureX casebook and ServiceNow Incident. If a Webex Teams room name and bot token are provided, a message with the investigation's results will be sent.\n\nTarget Group: Default TargetGroup\n\nTargets: CTR_For_Access_Token, CTR_API, Private_CTIA_Target, Webex Teams\n\nSteps:\n[] Fetch the blog post content and strip out any HTML\n[] Request a Threat Response access token and inspect the blog post content for observables\n[] Loop through each observable and get its Threat Response disposition\n[] For observables that weren't clean, conduct Threat Response enrichment to get sightings\n[] For modules with sightings, build the text to post to Webex\n[] Create the SecureX casebook and ServiceNow Incident, if a teams room is provided, post a message to Webex\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0001",
      "display_name": "Google TAG - Blog Post to SecureX Casebook\u0026SNOW",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01WSUXHAF6LPY2bHKhJ8lKCdQ9PcfIXP3KS",
        "name": "Condition Block",
        "title": "Set the environment URL",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set the environment URL",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01WSUXHBP3H435R0cf6Mq560HYUyE5OjXB8",
            "name": "Condition Branch",
            "title": "PROD-NAM",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-nam"
              },
              "continue_on_failure": false,
              "display_name": "PROD-NAM",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01WSUXHD8O3UL7YbcdJy3xy9e3X7INKnccu",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AF6G4RJpHdyZvmjgE3kL4moHBh$",
                      "variable_value_new": "visibility.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01WSUXHEQVX156VY5CQOSFsinYtI9FtAg7K",
            "name": "Condition Branch",
            "title": "PROD-EU",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-eu"
              },
              "continue_on_failure": false,
              "display_name": "PROD-EU",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01WSUXHGHMT596BE5Ki2HkqCxkNCzDD76GX",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AF6G4RJpHdyZvmjgE3kL4moHBh$",
                      "variable_value_new": "visibility.eu.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01WSUXHHJ88Q94RSK3WEkSgeJOTkrnnKkxM",
            "name": "Condition Branch",
            "title": "PROD-APJC",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-apjc"
              },
              "continue_on_failure": false,
              "display_name": "PROD-APJC",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01WSUXHILB3Z94ElFSI0xNFNbIVy9RwGrYj",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AF6G4RJpHdyZvmjgE3kL4moHBh$",
                      "variable_value_new": "visibility.apjc.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01WSUXHJIJCEX6mXvGDq585IKkFDy0Jy3U5",
        "name": "Group",
        "title": "Fetch and process blog post",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch and process blog post",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx",
            "name": "Execute Python Script",
            "title": "Fetch and clean blog post",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch and clean blog post",
              "script": "import sys,re,requests\n\n# Get the blog post URL from the script input\nblogUrl = sys.argv[1]\n\n# Request the content of the blog post\nblogRequest = requests.get(blogUrl, headers={ 'User-Agent': 'SecureX/definition_workflow_01FX7FQDZRDUX1TWgKJwTPBMaOWrgUOld2q' })\n\n# Make sure the request was successful\nif not blogRequest.status_code == 200:\n    sys.exit(\"Unable to fetch blog content. HTTP code \" + blogRequest.status_code)\n\n# Extract the HTML of the blog post\nblogHtml = blogRequest.text\n\n# Default the blog post to being unavailable in case we can't find it\npostTitle = \"Post Title Unavailable\"\n\n# Attempt to extract the blog post title from the HTML\ntitleMatches = re.search(r'\u003ctitle\u003e([^\u003c]+)\u003c\\/title\u003e', blogHtml, re.MULTILINE)\nif titleMatches:\n    # We found a \u003ctitle\u003e tag, so use that as the title\n    postTitle = titleMatches.group(1)\n    postTitle = postTitle[(postTitle.find(\":\") + 1):]\n    postTitle = postTitle.replace(\"\\\"\", \"'\")\n\n# Strip \u003cscript /\u003e tags\nblogHtml = re.sub(r'\u003cscript\\b[^\u003c]*(?:(?!\u003c\\/script\u003e)\u003c[^\u003c]*)*\u003c\\/script\u003e', '', str(blogHtml), flags=re.DOTALL)\n\n# Strip \u003cstyle /\u003e tags\nblogHtml = re.sub(r'\u003cstyle\\b[^\u003c]*(?:(?!\u003c\\/style\u003e)\u003c[^\u003c]*)*\u003c\\/style\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Strip other HTML\nblogHtml = re.sub(r'\u003c[^\u003c]+?\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Replace new lines with a space\nblogHtml = blogHtml.replace(\"\\n\", \" \")",
              "script_arguments": [
                "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH479FVP52PA8AGYZNr5Fzx0ojGYMZ$"
              ],
              "script_queries": [
                {
                  "script_query": "blogHtml",
                  "script_query_name": "blogHtml",
                  "script_query_type": "string"
                },
                {
                  "script_query": "postTitle",
                  "script_query_name": "postTitle",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXHLWP1TI3Ys5RXHD6fDtTPcy3EheBQ",
            "name": "Condition Block",
            "title": "Were we able to fetch and clean the blog post?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were we able to fetch and clean the blog post?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01WSUXHMWZ3OJ5l0BJ6QJnZfBRn85CtWx4L",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXHO8N4PJ3hiaQP6YjncUTufTLj4hpY",
                    "name": "Completed",
                    "title": "Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Failed",
                      "result_message": "Failed to fetch and/or clean the blog post content\n\nPython result: $activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.response_body$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01WSUXHP87EGD6Bw8TpBiwuj2CSnM7mYBvV",
        "name": "Group",
        "title": "Inspect the blog  content",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Inspect the blog  content",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01WSUXHR0PWHQ7YCymkceJ7atjnPvq6sdOi",
            "name": "Threat Response - Generate Access Token",
            "title": "Threat Response - Generate Access Token",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Generate Access Token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "CTR_For_Access_Token"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
              "workflow_name": "Threat Response - Generate Access Token"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXHSH62SI5tTzw0pN10DMrRmjwFt9sP",
            "name": "Set Variables",
            "title": "Set local token variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Set local token variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$",
                  "variable_value_new": "$activity.definition_activity_01WSUXHR0PWHQ7YCymkceJ7atjnPvq6sdOi.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF$",
                  "variable_value_new": "$activity.definition_activity_01WSUXHR0PWHQ7YCymkceJ7atjnPvq6sdOi.output.start_time$"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXHU3U10Q2LUoMTWXfTLzE9qJmHP8Wj",
            "name": "Threat Response - Inspect for Observables",
            "title": "Threat Response - Inspect for Observables",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Inspect for Observables",
              "input": {
                "variable_workflow_01PP7586F8ITB1sT6OpDzEF79wnWVOJk1N5": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$",
                "variable_workflow_01PP7586F8MQB2tFYbNgQC7xGbC7ZoXrOxR": "$activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.script_queries.blogHtml$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target_group": true
              },
              "workflow_id": "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
              "workflow_name": "Threat Response - Inspect for Observables"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXHVIUD217HWOOUDTlPngtm7rittnBh",
            "name": "JSONPath Query",
            "title": "Test for results",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Test for results",
              "input_json": "$activity.definition_activity_01WSUXHU3U10Q2LUoMTWXfTLzE9qJmHP8Wj.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.[0].value",
                  "jsonpath_query_name": "inspectTest",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXHX9E35G3ipVGzkb5tewYD06cle9Kr",
            "name": "Condition Block",
            "title": "Were there any observables?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were there any observables?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01WSUXHYAC7063OTpm2jlgiTRGJ0U9kefbK",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01WSUXHVIUD217HWOOUDTlPngtm7rittnBh.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXHZGWWDS4LQdMa9Lhn5hgNLiOAaZBB",
                    "name": "Completed",
                    "title": "Nothing to investigate",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Nothing to investigate",
                      "result_message": "The blog post \"$activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.script_queries.postTitle$\" was inspected but no observables to investigate were found",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01WSUXI0FKRTB4mj09KqHbmMRGxYLQ0ktyF",
            "name": "Read Table from JSON",
            "title": "Convert list of observables to table",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Convert list of observables to table",
              "input_json": "$activity.definition_activity_01WSUXHU3U10Q2LUoMTWXfTLzE9qJmHP8Wj.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
              "jsonpath_query": "$.*",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "type",
                  "column_type": "string"
                },
                {
                  "column_name": "value",
                  "column_type": "string"
                },
                {
                  "column_name": "disposition",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01WSUXI255QX43sV7EZVnI5WXqPZGnGGL9s",
        "name": "Group",
        "title": "Deliberate the observables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Deliberate the observables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01WSUXI40QW5A61hYz88G80UJS95qtjCIxT",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01WSUXI0FKRTB4mj09KqHbmMRGxYLQ0ktyF.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01WSUXI5ZBMY63MpluRE9Yv74REUxd5uh45",
                "name": "Threat Response - Deliberate Observable",
                "title": "Threat Response - Deliberate Observable",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response - Deliberate Observable",
                  "input": {
                    "variable_workflow_01PP77MLJ2S465LuOvU8mlP8mbbcgy9uTXN": "$activity.definition_activity_01WSUXI40QW5A61hYz88G80UJS95qtjCIxT.input.source_array[@].type$",
                    "variable_workflow_01PP77MLJ2XIE1H3D67PjcsCuGBsKCCBxLI": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$",
                    "variable_workflow_01PP77MLJ2ZVU1C4VxEfKYh2tlFk9iTx69p": "$activity.definition_activity_01WSUXI40QW5A61hYz88G80UJS95qtjCIxT.input.source_array[@].value$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
                  "workflow_name": "Threat Response - Deliberate Observable"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01WSUXI7H6AUZ39r6igGXzZhfZz1Ps6xelC",
                "name": "Group",
                "title": "Validate Threat Response token",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Validate Threat Response token",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXI95XLD901946GiskfKrhGyNHWch0a",
                    "name": "Calculate Date Time Difference",
                    "title": "Check token age",
                    "type": "core.calculate_date_time_difference",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Check token age",
                      "original_date": "$activity.definition_activity_01WSUXI5ZBMY63MpluRE9Yv74REUxd5uh45.output.end_time$",
                      "skip_execution": false,
                      "subtract_date": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF$"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01WSUXIA7LNSB63yImT1gqWhqNhDY7e3aLY",
                    "name": "Condition Block",
                    "title": "Is it over 8 minutes?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Is it over 8 minutes?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01WSUXIB8B8B26R1xWbPnuAllSOQ28uZhEh",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01WSUXI95XLD901946GiskfKrhGyNHWch0a.output.total_minutes$",
                            "operator": "gte",
                            "right_operand": 8
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01WSUXICQB25D5GbwGuVctkrXWscVk3vz4J",
                            "name": "Threat Response - Generate Access Token",
                            "title": "Threat Response - Generate Access Token",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response - Generate Access Token",
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "CTR_For_Access_Token"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                              "workflow_name": "Threat Response - Generate Access Token"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01WSUXIE1NFSK6hyjsFezKRHNoSFFM4JIoq",
                            "name": "Set Variables",
                            "title": "Set local token variables",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set local token variables",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$",
                                  "variable_value_new": "$activity.definition_activity_01WSUXICQB25D5GbwGuVctkrXWscVk3vz4J.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                                },
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF$",
                                  "variable_value_new": "$activity.definition_activity_01WSUXICQB25D5GbwGuVctkrXWscVk3vz4J.output.start_time$"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01WSUXIFSM3HV3MXy97BEOeCGaR3hZhTbU6",
                "name": "Update Row in Table",
                "title": "Update observable table with disposition",
                "type": "core.updaterowintable",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "columns": [
                    {
                      "column_name": "disposition",
                      "column_type": "string"
                    }
                  ],
                  "continue_on_failure": false,
                  "display_name": "Update observable table with disposition",
                  "input_table": "$activity.definition_activity_01WSUXI0FKRTB4mj09KqHbmMRGxYLQ0ktyF.output.read_table_from_json$",
                  "row": [
                    {
                      "key": "disposition",
                      "type": "string",
                      "value": "$activity.definition_activity_01WSUXI5ZBMY63MpluRE9Yv74REUxd5uh45.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$"
                    }
                  ],
                  "rows": {
                    "rows_matching_criteria": true,
                    "where_clause": "type == '$activity.definition_activity_01WSUXI40QW5A61hYz88G80UJS95qtjCIxT.input.source_array[@].type$' AND value == '$activity.definition_activity_01WSUXI40QW5A61hYz88G80UJS95qtjCIxT.input.source_array[@].value$'"
                  },
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01WSUXIH4OYZE3gC3NJyRXtDdWdNYWgPwZ4",
                "name": "Condition Block",
                "title": "Was this observable clean?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was this observable clean?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01WSUXII9J8HM5HfxADlhgNuoaypFiWk4bJ",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01WSUXI5ZBMY63MpluRE9Yv74REUxd5uh45.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$",
                        "operator": "ne",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01WSUXIJKEV9Z2wGuIvZ2Ku9tQjqiW7L2wY",
                        "name": "Execute Python Script",
                        "title": "Append this observable to our observable JSON",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Append this observable to our observable JSON",
                          "script": "import sys,json\n\n# Parse the existing list of observables\nexisting = json.loads(sys.argv[1])\n\n# Get the new observable information\nnewType = sys.argv[2]\nnewValue = sys.argv[3]\n\n# Append the new observable to the list\nexisting.append( { \"type\": newType, \"value\": newValue } )\n\n# Build the new JSON\nnewJson = json.dumps(existing)",
                          "script_arguments": [
                            "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH479OBO7L7JcyiOxVq3hMm0JynHQc$",
                            "$activity.definition_activity_01WSUXI40QW5A61hYz88G80UJS95qtjCIxT.input.source_array[@].type$",
                            "$activity.definition_activity_01WSUXI40QW5A61hYz88G80UJS95qtjCIxT.input.source_array[@].value$"
                          ],
                          "script_queries": [
                            {
                              "script_query": "newJson",
                              "script_query_name": "newJson",
                              "script_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01WSUXIKUP0LE1VAlyREi8dL5kzt37Ak5Bc",
                        "name": "Set Variables",
                        "title": "Update observable local variables",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Update observable local variables",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH479OBO7L7JcyiOxVq3hMm0JynHQc$",
                              "variable_value_new": "$activity.definition_activity_01WSUXIJKEV9Z2wGuIvZ2Ku9tQjqiW7L2wY.output.script_queries.newJson$"
                            },
                            {
                              "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH479XN83HOsjyra8ucTMGFmXPE9ch$",
                              "variable_value_new": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH479XN83HOsjyra8ucTMGFmXPE9ch$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01WSUXILZMQC578sCi9ydn3BU7FWAGF3vAQ",
            "name": "Condition Block",
            "title": "Were all of the observables clean?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were all of the observables clean?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01WSUXIMYFNN50CvK2lrC0dCR6XACNqsvdd",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH479XN83HOsjyra8ucTMGFmXPE9ch$",
                    "operator": "eq",
                    "right_operand": 0
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXIO1OP3A0gkphd40a3k5uw5QFrxcDe",
                    "name": "Completed",
                    "title": "No suspicious observables",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "No suspicious observables",
                      "result_message": "The blog post \"$activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.script_queries.postTitle$\" was investigated but all of the observables were clean",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01WSUXIP0J77O7EX3KMAKjzDcxf0VTyxfq2",
        "name": "Group",
        "title": "Enrich the observables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Enrich the observables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01WSUXIQIS3R653edWYhjITIrBeMcOiBsAz",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01WSUXI0FKRTB4mj09KqHbmMRGxYLQ0ktyF.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01WSUXIS5UF1M0kUkQh0bIBuA4m16eig59N",
                "name": "Condition Block",
                "title": "Is this observable clean?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Is this observable clean?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01WSUXIT7ULCW6RgobXufNI3YmL5HOSE5gt",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01WSUXIQIS3R653edWYhjITIrBeMcOiBsAz.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01WSUXIVLTG7F4C1xmnVUKx3ywFhlA2kytK",
                        "name": "Continue",
                        "title": "Skip this observable",
                        "type": "logic.continue",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Skip this observable",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01WSUXIXCF0UR6sZEwpzFq3tW1s4JE26pFj",
                "name": "Group",
                "title": "Validate Threat Response token",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Validate Threat Response token",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXIZ8SEQ14l5asUrP10Q25b5UAGSRWm",
                    "name": "Calculate Date Time Difference",
                    "title": "Check token age",
                    "type": "core.calculate_date_time_difference",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Check token age",
                      "original_date": "$activity.definition_activity_01WSUXIS5UF1M0kUkQh0bIBuA4m16eig59N.output.end_time$",
                      "skip_execution": false,
                      "subtract_date": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF$"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01WSUXJ0MV9T34jGSkt1a90opnW7ZNswYdW",
                    "name": "Condition Block",
                    "title": "Is it over 8 minutes?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Is it over 8 minutes?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01WSUXJ1UUUKD2GCzFV95IoJC3eEPJQzTuC",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01WSUXIZ8SEQ14l5asUrP10Q25b5UAGSRWm.output.total_minutes$",
                            "operator": "gte",
                            "right_operand": 8
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01WSUXJ3FFWSA1c8bHrcjDWihZ8AtBl6F2H",
                            "name": "Threat Response - Generate Access Token",
                            "title": "Threat Response - Generate Access Token",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response - Generate Access Token",
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "CTR_For_Access_Token"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                              "workflow_name": "Threat Response - Generate Access Token"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01WSUXJ4SVMPV2LjUhLWkydXdrBtOk7faP9",
                            "name": "Set Variables",
                            "title": "Set local token variables",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set local token variables",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$",
                                  "variable_value_new": "$activity.definition_activity_01WSUXJ3FFWSA1c8bHrcjDWihZ8AtBl6F2H.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                                },
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF$",
                                  "variable_value_new": "$activity.definition_activity_01WSUXJ3FFWSA1c8bHrcjDWihZ8AtBl6F2H.output.start_time$"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01WSUXJ76HD953k2Djy6LdFYERTUL8FtwOB",
                "name": "Threat Response - Enrich Observable",
                "title": "Threat Response - Enrich Observable",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response - Enrich Observable",
                  "input": {
                    "variable_workflow_01PP78TYDTQ2L5AWh7XpLPkXldkBYssq6SC": "$activity.definition_activity_01WSUXIQIS3R653edWYhjITIrBeMcOiBsAz.input.source_array[@].value$",
                    "variable_workflow_01PP78TYDTTUQ6Qtv47uK5sgOFSbJ4b4Cno": "$activity.definition_activity_01WSUXIQIS3R653edWYhjITIrBeMcOiBsAz.input.source_array[@].type$",
                    "variable_workflow_01PP78TYDTV5R5JK6DtYaS5E95bWbZBstS5": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
                  "workflow_name": "Threat Response - Enrich Observable"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01WSUXJ8KU8AN6mlnhdYeI8l58Dg7hduKop",
                "name": "Read Table from JSON",
                "title": "Convert list of enrichments to table",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Convert list of enrichments to table",
                  "input_json": "$activity.definition_activity_01WSUXJ76HD953k2Djy6LdFYERTUL8FtwOB.output.variable_workflow_01PP78TYDTWG01QGHDq5uwDKdvEqS9CdcYg$",
                  "jsonpath_query": "$.data[*]",
                  "persist_output": false,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "module",
                      "column_type": "string"
                    },
                    {
                      "column_name": "module_type",
                      "column_type": "string"
                    },
                    {
                      "column_name": "data",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01WSUXJ9TA9NG4JIBKxYLi3updQoCeWyXSR",
                "name": "Condition Block",
                "title": "Were there any enrichment results?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were there any enrichment results?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01WSUXJATB6IW1s84sAuN2g5eXIi7BqlMRv",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01WSUXJ8KU8AN6mlnhdYeI8l58Dg7hduKop.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01WSUXJC9Q4YB5cOgFFHprxuaMo123s47oP",
                        "name": "Continue",
                        "title": "Skip this observable",
                        "type": "logic.continue",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Skip this observable",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01WSUXJD9WYSS3tJb8h194FRImb4uCWULYx",
                "name": "For Each",
                "title": "For each enriched module",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For each enriched module",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_01WSUXJ8KU8AN6mlnhdYeI8l58Dg7hduKop.output.read_table_from_json$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXJF0PXWB6VICDgEzcitcjJeIuUHAHv",
                    "name": "JSONPath Query",
                    "title": "Extract sightings",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract sightings",
                      "input_json": "$activity.definition_activity_01WSUXJD9WYSS3tJb8h194FRImb4uCWULYx.input.source_array[@].data$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.sightings.count",
                          "jsonpath_query_name": "sightingCount",
                          "jsonpath_query_type": "string"
                        },
                        {
                          "jsonpath_query": "$.sightings.docs",
                          "jsonpath_query_name": "sightingData",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01WSUXJG6RBCS3QMstf4L6qqDnI1n7yDX4W",
                    "name": "Condition Block",
                    "title": "Do we care about this module?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Do we care about this module?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01WSUXJH9GO3Z382fRPyt2kw8aXZq0qux7U",
                        "name": "Condition Branch",
                        "title": "No sightings, skip it",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01WSUXJF0PXWB6VICDgEzcitcjJeIuUHAHv.output.succeeded$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "No sightings, skip it",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01WSUXJIH6Q681lX377ILq7J82jpd8jsewd",
                            "name": "Continue",
                            "title": "Skip this module",
                            "type": "logic.continue",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Skip this module",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01WSUXJJILVAZ5EcMatpNiKy5qz75YxZl6K",
                    "name": "Execute Python Script",
                    "title": "Extract sightings and targets",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Extract sightings and targets",
                      "script": "import sys,json\n\n# Get the name of the module being investigated\nmoduleName = sys.argv[1]\n\n# Parse the existing list of sightings and targets\nexistingSightings = json.loads(sys.argv[3])\nexistingTargets = json.loads(sys.argv[4])\n\n# Parse the new sightings\nnewSightings = json.loads(sys.argv[2])\n\n# Loop through each sighting\nfor sighting in newSightings:\n\tsighting[\"module_name\"] = moduleName\n\t\n\t# Append this sighting to the master list\n\texistingSightings.append(sighting)\n\t\n\t# Check if this sighting has any targets\n\tif \"targets\" in sighting.keys() and len(sighting[\"targets\"]) \u003e 0:\n\t\t# Loop through each target\n\t\tfor target in sighting[\"targets\"]:\n\t\t\t# Check if this target is an endpoint\n\t\t\tif target[\"type\"] == \"endpoint\":\n\t\t\t\t# Loop through each observable\n\t\t\t\tfor observable in target[\"observables\"]:\n\t\t\t\t\tif observable[\"type\"] == \"amp_computer_guid\" and not observable in existingTargets:\n\t\t\t\t\t\texistingTargets.append(observable)\n\n# Build the new JSON\nnewSightings = json.dumps(existingSightings)\nnewTargets = json.dumps(existingTargets)",
                      "script_arguments": [
                        "$activity.definition_activity_01WSUXJD9WYSS3tJb8h194FRImb4uCWULYx.input.source_array[@].module$",
                        "$activity.definition_activity_01WSUXJF0PXWB6VICDgEzcitcjJeIuUHAHv.output.jsonpath_queries.sightingData$",
                        "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH4797902wMICBdUmBMlzvcPMvdKdM$",
                        "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47ANQM3yIokMsZwztjmtmWYPs3fg$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "newSightings",
                          "script_query_name": "newSightings",
                          "script_query_type": "string"
                        },
                        {
                          "script_query": "newTargets",
                          "script_query_name": "newTargets",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01WSUXJKXB7380mCynPuwb3Aoou8KflWOSG",
                    "name": "Set Variables",
                    "title": "Update local variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update local variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH4797902wMICBdUmBMlzvcPMvdKdM$",
                          "variable_value_new": "$activity.definition_activity_01WSUXJJILVAZ5EcMatpNiKy5qz75YxZl6K.output.script_queries.newSightings$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47ANQM3yIokMsZwztjmtmWYPs3fg$",
                          "variable_value_new": "$activity.definition_activity_01WSUXJJILVAZ5EcMatpNiKy5qz75YxZl6K.output.script_queries.newTargets$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01WSUXJM7KHYY1KKO8p7uZDZhWzuXPXMkqC",
        "name": "Group",
        "title": "Validate Threat Response token",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Validate Threat Response token",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01WSUXJNSSNRT04TvZYiRjKopyURxV0RsKN",
            "name": "Calculate Date Time Difference",
            "title": "Check token age",
            "type": "core.calculate_date_time_difference",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Check token age",
              "original_date": "$activity.definition_activity_01WSUXIP0J77O7EX3KMAKjzDcxf0VTyxfq2.output.end_time$",
              "skip_execution": false,
              "subtract_date": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF$"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXJOY6O5F1DTG8Y23toxQOMWNhc50Nr",
            "name": "Condition Block",
            "title": "Is it over 8 minutes?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is it over 8 minutes?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01WSUXJQ1J3WY1ze8xkON4jIWsGDchsqrN3",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01WSUXJNSSNRT04TvZYiRjKopyURxV0RsKN.output.total_minutes$",
                    "operator": "gte",
                    "right_operand": 8
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXJRNJYWP6ua8LsytvgKITO3ds7untQ",
                    "name": "Threat Response - Generate Access Token",
                    "title": "Threat Response - Generate Access Token",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response - Generate Access Token",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "CTR_For_Access_Token"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                      "workflow_name": "Threat Response - Generate Access Token"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01WSUXJT1ADIQ3nIMbKBl0xfFLhoTJlkTfs",
                    "name": "Set Variables",
                    "title": "Set local token variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local token variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$",
                          "variable_value_new": "$activity.definition_activity_01WSUXJRNJYWP6ua8LsytvgKITO3ds7untQ.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH478Z0W60Bsg8ZIPDdrSTKTx4G3DF$",
                          "variable_value_new": "$activity.definition_activity_01WSUXJRNJYWP6ua8LsytvgKITO3ds7untQ.output.start_time$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01WSUXJUCCOCM2NPFKLOlXsC4iTVsGXdM1s",
        "name": "Group",
        "title": "Create casebook and post to Webex",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Create casebook and post to Webex",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01WSUXJVZ6NE136yHnTVgIcH2FAbTvR4Nt4",
            "name": "Execute Python Script",
            "title": "Convert sighting data to usable text for messaging",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Convert sighting data to usable text for messaging",
              "script": "import sys,json\n\n# Get and parse the sighting data\nsightings = json.loads(sys.argv[1])\n\n# Placeholders for output\nsightingCounts = {}\nmoduleNames = []\ntargets = []\n\n# Loop through each sighting\nfor sighting in sightings:\n\t# If there aren't any targets, initialize that array index to an empty list\n\tif not \"targets\" in sighting:\n\t\tsighting[\"targets\"] = []\n\t\t\n\t# Loop through each target\n\ttargetCount = 0\n\tfor target in sighting[\"targets\"]:\n\t\t# Remove the observed time (so two of the same target aren't considered different)\n\t\tdel target[\"observed_time\"]\n\t\t\n\t\t# Add this target to our master list if it's not already in the list (and count it)\n\t\tif not target in targets:\n\t\t\ttargetCount += 1\n\t\t\ttargets.append(target)\n\t\n\t# Is this module already in our count array?\n\tif sighting[\"module_name\"] in sightingCounts.keys():\n\t\t# Yes, so increment the counts\n\t\tsightingCounts[sighting[\"module_name\"]][\"count\"] += 1\n\t\tsightingCounts[sighting[\"module_name\"]][\"targets\"] += targetCount\n\telse:\n\t\t# No, so add it and its counts\n\t\tsightingCounts[sighting[\"module_name\"]] = {\n\t\t\t\"count\": 1,\n\t\t\t\"targets\": targetCount\n\t\t}\n\t\tmoduleNames.append(sighting[\"module_name\"])\n\n# Placeholders for output\nmarkdownSummary = \"\"\nmarkdownTruncated = False\n\n# Were there any sightings to begin with?\nif len(sightings) == 0:\n\tmarkdownSummary = \"* No sightings or targets were found\"\nelse:\n\t# Loop through the sighting counts\n\tfor module in moduleNames:\n\t\t# Make sure the markdown summary (for Threat Response and Webex) isn't already too long\n\t\tif len(markdownSummary.encode(\"utf-8\")) \u003e 4000 and not markdownTruncated:\n\t\t\t# It's getting too long, so add a message indicating that the text was truncated\n\t\t\tmarkdownSummary = markdownSummary + \"\\n\\n Additional information was available but truncated due to message length\"\n\t\t\tmarkdownTruncated = True\n\t\telif not markdownTruncated:\n\t\t\t# The message isn't too long, so append this module\n\t\t\tmarkdownSummary = markdownSummary + (\"\\n\" if len(markdownSummary) \u003e 0 else \"\") + \"* Module **\" + module + \"** returned **\" + str(sightingCounts[module][\"count\"]) + \" sightings** with a total of **\" + str(sightingCounts[module][\"targets\"]) + \" targets**\"",
              "script_arguments": [
                "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH4797902wMICBdUmBMlzvcPMvdKdM$"
              ],
              "script_queries": [
                {
                  "script_query": "markdownSummary",
                  "script_query_name": "markdownSummary",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXJXJS0E63oMbDi13ZKt71UZuV3tyTt",
            "name": "Threat Response - Create Casebook",
            "title": "Threat Response - Create Casebook",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Create Casebook",
              "input": {
                "variable_workflow_01PP75X6NM0AY6YDlJckkMg6hCbMEMGO72O": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH479OBO7L7JcyiOxVq3hMm0JynHQc$",
                "variable_workflow_01PP75X6NM1M46Jjob8LUKg8R3yRRVOvu9q": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AW9W4o6IB3RRSVr3prJAAqseuQ$",
                "variable_workflow_01PP75X6NM2V27Or3EssfIABNZiE45Ddziu": "amber",
                "variable_workflow_01PP75X6NM4123PBwUedJ5QqeBr8G1sefjQ": "Google TAG: $activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.script_queries.postTitle$",
                "variable_workflow_01PP75X6NM54W5qTbpCb1h6bTTrp7eFQjaq": "Casebook generated from a Google TAG blog post",
                "variable_workflow_01PP75X6NM7FE4BmQ3AKIykyWFDSV9umy02": "SecureX orchestration generated this casebook from an RSS feed\n\n| Post Title | $activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.script_queries.postTitle$ |\n|---------------|-------------|\n| Post URL | [$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH479FVP52PA8AGYZNr5Fzx0ojGYMZ$]($workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH479FVP52PA8AGYZNr5Fzx0ojGYMZ$) |\n| Time | $activity.definition_activity_01WSUXIP0J77O7EX3KMAKjzDcxf0VTyxfq2.output.end_time$ |\n\n**Sighting Summary**:\n$activity.definition_activity_01WSUXJVZ6NE136yHnTVgIcH2FAbTvR4Nt4.output.script_queries.markdownSummary$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
              "workflow_name": "Threat Response - Create Casebook"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUY46R9WPA2FhW8AIy2ENxfzs154nR57",
            "name": "Service Now - Create Incident",
            "title": "Service Now - Create Incident",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Service Now - Create Incident",
              "input": {
                "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "Incident generated from a Google TAG blog post",
                "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "Incident generated from a Google TAG blog post",
                "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 2,
                "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 2,
                "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "[code]\u003cbr\u003eGoogle TAG Blog Post - Sightings found:\u003c/br\u003e\n\u003cbr\u003eTitle: $activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.script_queries.postTitle$\u003c/br\u003e\n\u003cbr\u003eShort Description: SecureX Orchestration Generated incident based on Google TAG RSS feed\u003c/br\u003e\n\u003cbr\u003eDescription: \u003c/br\u003e\u003cbr\u003eURL: $workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH479FVP52PA8AGYZNr5Fzx0ojGYMZ$\u003c/br\u003e\n\u003cbr\u003eSightings: $activity.definition_activity_01WSUXJVZ6NE136yHnTVgIcH2FAbTvR4Nt4.output.script_queries.markdownSummary$\u003c/br\u003e[/code]",
                "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "osanniko",
                "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2",
                "variable_workflow_01QQRD42S934T3YIYvzeOCjJdQHxZ4Z5r3D": "",
                "variable_workflow_01QQRSG209XTG5eECReNmsSlaQJVSMolhkC": ""
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "ServiceNow"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
              "workflow_name": "Service Now - Create Incident v2"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01WSUXJZ1YUOQ3leXTlHB2jr1AZoo2T8zsP",
            "name": "Condition Block",
            "title": "Was a Webex Teams room provided?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Was a Webex Teams room provided?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01WSUXK03GLOH5zZxMwZBmJjNib6tEAdcHx",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH47A65O30PkUtWDBC5rivw0rea6Ua$",
                    "operator": "ne",
                    "right_operand": ""
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01WSUXK1Q21WG2yhxhvaqqdrmbwOvEnCYbZ",
                    "name": "Webex Teams - Search for Room",
                    "title": "Webex Teams - Search for Room",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Webex Teams - Search for Room",
                      "input": {
                        "variable_workflow_01PP790MCX1DN3EitpQebkUyJS65DbwS3nU": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH47B4TE23rLJNXQ9OcTPnIo2KRMMW$",
                        "variable_workflow_01PP790MCXB392D3R8pxh9fgOTjTde2bcMW": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH47A65O30PkUtWDBC5rivw0rea6Ua$",
                        "variable_workflow_01PP790MCXHP55YE6ylOEITWsWbUFJeyWGv": "",
                        "variable_workflow_01PP790MCXM9W1MUwo85y8iNRCoQuQ4RGNa": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "Webex Teams"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
                      "workflow_name": "Webex - Search for Room"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01WSUXK3H7ZMS4vXASE1XPjvQRqfnhVL19f",
                    "name": "Condition Block",
                    "title": "Did we find the room?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Did we find the room?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01WSUXK52QGGX1Z4q410KExOuPcH83WU9ei",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01WSUXK1Q21WG2yhxhvaqqdrmbwOvEnCYbZ.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01WSUXK6QL8Q2431mGCufqklLT1SHNcfPWx",
                            "name": "Webex Teams - Post Message to Room",
                            "title": "Webex Teams - Post Message to Room",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Webex Teams - Post Message to Room",
                              "input": {
                                "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "$activity.definition_activity_01WSUXK1Q21WG2yhxhvaqqdrmbwOvEnCYbZ.output.variable_workflow_01PP790MCXJ7Y5cAWcGZWbG4Es0126zb1I6$",
                                "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH47B4TE23rLJNXQ9OcTPnIo2KRMMW$",
                                "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "A SecureX casebook has been created for the blog post [$activity.definition_activity_01WSUXHKXNDZS440xClyi8SCCMCNtsui1Tx.output.script_queries.postTitle$]($workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.input.variable_workflow_01WSUXH479FVP52PA8AGYZNr5Fzx0ojGYMZ$) from Talos. [Click here](https://$workflow.definition_workflow_01WSUXH3ZDY620e0G4z0NekHE6cPSn1JmM2.local.variable_workflow_01WSUXH47AF6G4RJpHdyZvmjgE3kL4moHBh$/investigate?spid=$activity.definition_activity_01WSUXJXJS0E63oMbDi13ZKt71UZuV3tyTt.output.variable_workflow_01PP75X6NLWYO1BiZbBFEXJyqmmfiQcqId3$) to investigate\n\n**Sighting Summary:**\n$activity.definition_activity_01WSUXJVZ6NE136yHnTVgIcH2FAbTvR4Nt4.output.script_queries.markdownSummary$",
                                "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                                "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Webex Teams"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                              "workflow_name": "Webex - Post Message to Room"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
    "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
    "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
    "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
    "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
  ],
  "dependent_workflows": [
    "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
    "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
    "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
    "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
    "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01PP790MKJNWV6XyJuLdUyNlM2UV3JJACez",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
  ]
}